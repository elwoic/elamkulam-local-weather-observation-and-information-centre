<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ELWOIC Login</title>
<style>
body {
  display: flex; justify-content: center; align-items: center;
  height: 100vh; background: #0f172a; color: white;
  font-family: system-ui;
}
.box {
  background: #020617; padding: 30px;
  border-radius: 12px; width: 300px;
}
input, button {
  width: 100%; padding: 10px;
  margin-top: 10px; border-radius: 6px;
  border: none;
}
button {
  background: #2563eb; color: white;
  font-weight: bold; cursor: pointer;
}
.error { color: #f87171; font-size: 0.85rem; }
</style>
</head>
<body>

<div class="box">
  <h2>üîê ELWOIC Access</h2>
  <input id="email" type="email" placeholder="Email">
  <input id="password" type="password" placeholder="Password">
  <button onclick="login()">Login</button>
  <div class="error" id="err"></div>
</div>

<script type="module">
// TOP OF DATA CENTRE PAGE
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

// Initialize Auth specifically for the Admin Project
const authApp = initializeApp({
    apiKey: "AIzaSyALWX2l-9_6izgvt_JerJjTDbgNc5oT2VQ",
    authDomain: "administration-protal.firebaseapp.com"
}, "authCheck"); // <--- The "authCheck" name is important!

const auth = getAuth(authApp);

onAuthStateChanged(auth, user => {
    if (!user) window.location.replace("data_login.html");
});
  
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

window.login = () => {
    // Correctly grabbing elements by ID
    const emailValue = document.getElementById('email').value;
    const passwordValue = document.getElementById('password').value;
    const errField = document.getElementById('err');

    errField.textContent = "Authenticating..."; // Feedback for the user

    signInWithEmailAndPassword(auth, emailValue, passwordValue)
    .then(() => {
        // SUCCESS: Go to the Data Centre page
        // IMPORTANT: Ensure this filename matches your weather log page!
        window.location.href = "index.html"; 
    })
    .catch(e => {
        console.error(e.code);
        if (e.code === 'auth/invalid-credential' || e.code === 'auth/wrong-password') {
            errField.textContent = "Invalid Email or Password.";
        } else if (e.code === 'auth/invalid-email') {
            errField.textContent = "Please enter a valid email address.";
        } else {
            errField.textContent = "Error: " + e.message;
        }
    });
};
</script>
</body>
</html>
