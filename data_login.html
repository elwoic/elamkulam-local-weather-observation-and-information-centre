<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ELWOIC Login</title>

<style>
body {
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  background:#0f172a;
  color:white;
  font-family:system-ui;
}

.box {
  background:#020617;
  padding:30px;
  border-radius:12px;
  width:300px;
  box-shadow:0 10px 30px rgba(0,0,0,.4);
}

input, button {
  width:100%;
  padding:10px;
  margin-top:10px;
  border-radius:6px;
  border:none;
}

button {
  background:#2563eb;
  color:white;
  font-weight:bold;
  cursor:pointer;
}

button:disabled {
  opacity:.6;
  cursor:not-allowed;
}

.error {
  margin-top:10px;
  color:#f87171;
  font-size:.85rem;
}
</style>
</head>

<body>

<div class="box">
  <h2>üîê ELWOIC Access</h2>
  <input id="email" type="email" placeholder="Email" autocomplete="username">
  <input id="password" type="password" placeholder="Password" autocomplete="current-password">
  <button id="loginBtn">Login</button>
  <div class="error" id="err"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getAuth,
  signInWithEmailAndPassword,
  setPersistence,
  browserLocalPersistence
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

/* üîê ADMIN AUTH PROJECT */
const adminConfig = {
  apiKey: "AIzaSyALWX2l-9_6izgvt_JerJjTDbgNc5oT2VQ",
  authDomain: "administration-protal.firebaseapp.com"
};

/* Named app to avoid collisions */
const app = initializeApp(adminConfig, "adminAuthApp");
const auth = getAuth(app);

/* Ensure login survives reloads */
await setPersistence(auth, browserLocalPersistence);

const emailInput = document.getElementById("email");
const passInput = document.getElementById("password");
const errField  = document.getElementById("err");
const loginBtn  = document.getElementById("loginBtn");

function showError(msg) {
  errField.textContent = msg;
  loginBtn.disabled = false;
}

function login() {
  const email = emailInput.value.trim();
  const password = passInput.value;

  if (!email || !password) {
    showError("Please enter both email and password.");
    return;
  }

  errField.textContent = "Verifying access‚Ä¶";
  loginBtn.disabled = true;

  signInWithEmailAndPassword(auth, email, password)
    .then(() => {
      /* ‚úÖ SUCCESS */
      window.location.replace("index.html");
    })
    .catch(err => {
      console.error("Login error:", err.code);

      switch (err.code) {
        case "auth/user-not-found":
        case "auth/invalid-credential":
          showError("Invalid email or password.");
          break;

        case "auth/too-many-requests":
          showError("Too many attempts. Try again later.");
          break;

        case "auth/network-request-failed":
          showError("Network error. Check your connection.");
          break;

        default:
          showError("Login failed. " + err.message);
      }
    });
}

/* Button click */
loginBtn.addEventListener("click", login);

/* Enter key support */
document.addEventListener("keydown", e => {
  if (e.key === "Enter") login();
});
</script>

</body>
</html>
