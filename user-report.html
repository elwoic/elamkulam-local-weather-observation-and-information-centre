<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>User Reports | ELWOIC</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
.report-card img {
    max-height: 120px;
    width: auto;
    border-radius: 6px;
    margin-top: 8px;
    object-fit: cover;
}
</style>
</head>
<body class="bg-slate-50 font-sans">

<div class="container mx-auto px-4 py-6">
    <h1 class="text-2xl font-bold text-blue-900 mb-4">Community Weather Reports</h1>
    <div id="reportsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
    <div id="emptyMsg" class="hidden text-center text-gray-600 mt-8">
        No reports are available at the moment.
    </div>
</div>

<script type="module">
// ... (initialization and setup code remains the same) ...

onValue(reportsRef, (snapshot) => {
    const data = snapshot.val();
    reportsContainer.innerHTML = '';

    if (!data) {
        emptyMsg.classList.remove('hidden');
        return;
    }

    emptyMsg.classList.add('hidden');

    Object.values(data).forEach(report => {
        // Only display reports approved to show on site
        if (report.show_on_site !== "yes") return;

        const reporterName = (report.show_name === "yes") ? report.name : "Anonymous";

        const card = document.createElement('div');
        card.className = 'bg-white p-4 rounded shadow report-card border-l-4 border-blue-600';

        card.innerHTML = `
            <h3 class="text-lg font-semibold text-blue-800">${report.report_type || "Weather Report"}</h3>  <hr class="my-1 border-gray-200">
            <p class="text-sm text-gray-600"><strong>Reporter:</strong> ${reporterName}</p>
            <p class="text-sm text-gray-600"><strong>Place:</strong> ${report.location}</p>
            <p class="text-sm text-gray-600"><strong>Time:</strong> ${report.time || "N/A"}</p>
            <p class="mt-2 text-gray-700 whitespace-pre-wrap"><strong>The reporter says:</strong><br>${report.observation}</p>
            ${report.photo_url && report.photo_url !== 'N/A' ? `
                <div class="mt-2">
                    <strong>Photos:</strong><br>
                    <img src="${report.photo_url}" alt="Weather Photo" class="mt-1 report-card-img">
                </div>
            ` : ''}
        `;
        reportsContainer.appendChild(card);
    });
});
</script>

</body>
</html>
