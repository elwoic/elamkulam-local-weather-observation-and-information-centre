<!DOCTYPE html>
<html>
<head>
  <title>Weather Admin</title>
</head>
<body>

<h2>Weather Administration</h2>
<button onclick="logout()">Logout</button><br><br>

<label>Date:</label>
<input type="date" id="date"><br><br>

<div id="hours"></div>

<button onclick="saveWeather()">SAVE WEATHER</button>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();

/* PROTECT PAGE */
auth.onAuthStateChanged(user => {
  if (!user) window.location.href = "admin-login.html";
});

/* HOURS */
const hourList = [
 "00:00","02:00","04:00","06:00","08:00","10:00",
 "12:00","14:00","16:00","18:00","20:00","22:00"
];

hourList.forEach(h => {
  hours.innerHTML += `
    <label>${h}</label>
    <input id="h_${h}" placeholder="cl / pc / lr / hr"><br>
  `;
});

/* SAVE */
function saveWeather() {
  const date = document.getElementById("date").value;
  if (!date) return alert("Select date");

  let data = {};
  hourList.forEach(h => {
    const v = document.getElementById("h_" + h).value;
    if (v) data[h] = v;
  });

  db.ref("weatherData/" + date).set(data)
    .then(() => alert("Saved successfully"))
    .catch(e => alert(e.message));
}

function logout() {
  auth.signOut().then(() => {
    window.location.href = "w-login.html";
  });
}
</script>

</body>
</html>
